/**
 * Router
 * Version: 0.0.1
 * Author: Dmitry Shimkin <dmitryshimkin@gmail.com>
 * License: MIT
 * https://github.com/dmitryshimkin/router
 */
!function(t){"use strict";function n(t){function n(){}if(v)return Object.create(t);n.prototype=t;var e=new n;return n.prototype=null,e}function e(t,n){return o(n,function(n,e){t[e]=n}),t}function o(t,n,e){if("length"in t)for(var o=0,u=t.length;u>o;o++)n.call(e,t[o],o);else for(var r in t)t.hasOwnProperty(r)&&n.call(e,t[r],r);return t}function u(t){return"function"==typeof t}function r(t){try{console.warn(t)}catch(n){}}function i(t,n){this.name=t,this.pattern=n}function c(t){e(this,t)}function a(t,n,e){e.queue.push(t),e.isProcessing||g(n,e)}function s(t){return t?t.slice(1,t.length):[]}function f(t,n){for(var e=t.length;e--;)if(t[e].name===n)return t[e];return null}function l(t,n){return null!==f(t,n.name)}function h(t,n){var e=[];return o(t,function(t){var o=t.matches(n);o&&e.push({name:t.name,params:s(o)})}),e}function p(t,n){var e=h(n.routes,n.location),r=n.context||null,i=[],a=[],s=[],p=[];o(n.activeRoutes,function(t){var n=f(e,t.name);n?(i.push(n),p.push(n)):s.push({name:t.name})}),o(e,function(t){l(i,t)||(i.push(t),a.push(t))}),n.activeRoutes=i,u(t.onRoute)&&(p.length&&t.onRoute.call(r,new c({type:"routechange",routes:p})),s.length&&t.onRoute.call(r,new c({type:"routeend",routes:s})),a.length&&t.onRoute.call(r,new c({type:"routestart",routes:a})))}function g(t,n){var e=n.queue.shift();e&&(n.isProcessing=!0,n.location=e,p(t,n),n.queue.length&&g(t,n),n.isProcessing=!1)}function m(){function t(t,n){c.routes[t]?r("Route `"+t+"` is already added"):c.routes[t]=new i(t,n)}function e(){return c.location}function o(t){t!==c.location&&a(t,u,c)}var u=n(m.prototype),c={queue:[],isProcessing:!1,activeRoutes:[],location:"",routes:{}};return u.addRoute=t,u.getLocation=e,u.setLocation=o,u}var v=u(Object.create);i.prototype.matches=function(t){return t.match(this.pattern)},"function"==typeof define&&define.amd?define("Router",m):"object"==typeof exports?module.exports=m:t.Router=m}(this);